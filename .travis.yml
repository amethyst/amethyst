---
env: 
  - FORMATTING=true
  - FORMATTING=false
language: rust
matrix: 
  allow_failures: 
      - env: "FORMATTING=false"
        rust: nightly
  exclude: 
      - env: "FORMATTING=true"
        rust: stable
      - env: "FORMATTING=true"
        rust: beta
      - env: "FORMATTING=true"
        os: osx
        rust: nightly
rust: 
  - stable
  - beta
  - nightly

# Build the Bors staging and trying branches, plus PRs to develop, master, and
# the latest release branch.
branches:
  only:
    - staging
    - trying
    - develop
    - master
    - /release-.*/

# Test on both Linux and OS X.
os:
  - linux
  - osx

# Install ALSA development libraries before compiling on Linux.
addons:
  apt:
    packages:
      - libasound2-dev
      - cmake

# Since this build doesn't require sudo, we can turn it off and improve build
# performance.
sudo: false

# Force third-party crates to persist from previous builds and update only when
# needed.
cache: cargo

# Allow binaries installed from Cargo.
before_script:
  - export PATH=$PATH:/home/travis/.cargo/bin

script: ./travis_script.sh 

# Push notifications to `amethyst/general` and `amethyst/engine` Gitter chats.
notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/9735c01977c1df3de5cb
